# **CL0P** - Exploiting MOVEit Vulnerability [CVE-2023-34362]
## By: Adam Clark

<br />

### **Executive Summary**

The Russian-backed CL0P cyber gang, also known as TA505, was discovered to be targeting a significant vulnerability in the widely used Managed File Transfer (MFT) solution known as MOVEit, developed by Progress Software. CL0P is a highly aggressive Russian cyber gang that is considered one of the largest phishing and malspam distributors worldwide. 

<br />

### **Introduction**

The MOVEit file transfer vulnerability (CVE-2023-34362), a SQL injection vulnerability, was first publicly reported to be exploited beginning on May 27, 2023. The vulnerability allowed for unauthenticated access to MOVEit Transfer's database and, depending on which database engine was used, could allow database elements to be altered or deleted. This exploitation can lead to sensitive data being stolen, such as passwords, credit card details, or personal user information. Both on-premises and cloud versions were impacted.

As of November 2023, this vulnerability has been exploited massively, targeting multiple organizations and industries such as government agencies, financial institutions, and healthcare providers.

<br />

### **Infection Vector**

Initial Infection began with internet facing MOVEit Transfer web applications being infected with a web shell, LEMURLOOT, which was used to steal data from underlying databases.

<br />

### **Technical Details**

The **human2.aspx** backdoor file was believed to be uploaded during the attack which allowed the attacker to do the following:

- Obtain a list of all folders, files, and users within MOVEit. (Password hashes were not returned.)
- Download any file.
- Insert Admin backdoor user and give attackers an active session to bypass credentials.

In a very simplified manner, the **human2.aspx** backdoor functioned as follows:

- On page load, a header was checked against a hard-coded password. A 404 code is returned if the password does not match.
- A request header value is read in with a value of -1, -2, or null. Depending on this value a set of actions will occur:
  - If -1:
    - The Azure Blog Storage Account, Blob Key, and Blob Container IDs are appended to the response header.
    - A list of all files/folders, file owners/size, and institution names are obtained and returned.
  - If -2:
    - A backdoor user named **Health Check Service** is deleted from the users table.
  - If Null:
    - The backdoor adds an admin user named **Health Check Service** in to the users table.
    - The backdoor creates and inserts a new active session for this user.

<br />

### **Indicators of Compromise (IoCs)**

Progress Software has provided a list of around 100 IoCs for the MOVEit Transfer vulnerability that can be downloaded from their website [here](https://community.progress.com/sfc/servlet.shepherd/document/download/0694Q00000PoJAOQA3?operationContext=S1). Some examples include:

- Filenames
  - Human2.aspx, human2,aspx.lnk
- HTTP Requests
  - POST /moveitisapi/moveitisapi.dll
  - GET /human2.aspx
- IPv4 Addresses
  - 5.252.23.116
  - 148.113.152.144
- CIDR
  - 188.241.58.0/24
  - 5.252.191.0/24
- Domain
  - Dojustit[.]mooo[.]com
- SHA256 Hashes
  - 0b3220b11698b1436d1d866ac07cc90018e59884e91a8cb71ef8924309f1e0e9
  - 58ccfb603cdc4d305fddd52b84ad3f58ff554f1af4d7ef164007cb8438976166

<br />

### **Mitigation and Prevention**

Progress Software quickly released fixed versions of MOVEit Transfer. To prevent successful exploitation, the following mitigation measures were advised:

1. Disable HTTP and HTTPS traffic to MOVEit Transfer.
2. Data Cleanup: remove unauthorized files/accounts and reset service account credentials.
3. Patch MOVEit Transfer to a fixed version.
4. Verify the above steps were successfully taken.
5. Enable HTTP and HTTPS traffic.
6. Continuously monitor network, endpoints, and logs for IOCs.

<br />

### **Timeline of Events**

- April 27, 2022 – Kroll observed activity like MOVEit Transfer exploitation.
- March 3, 2023 – Earliest scanning activity to discover internet-accessible MOVEit installations.
- May 9, 2023 – Earliest SQL injection attempts on MOVEit Transfer endpoints.
- May 27, 2023 – Publicly reported exploitation of the vulnerability by Rapid7.
- May 31, 2023 – MOVEit Transfer vendor, Progress Software, releases security advisory.
- June 2, 2023 – CVE-2023-34362 assigned.
- June 5, 2023 – CL0P cyber gang claims responsibility for attacks.
- June 12, 2023 – Rapid7 releases a full exploit chain for vulnerability.

<br />

### **Conclusion**

The Russian-backed cyber gang, CL0P exploited a critical SQL injection vulnerability (CVE-2023-34362) in MOVEit, a widely used file transfer solution developed by Progress Software. This vulnerability allowed for unauthorized access to databases posing significant risk to sensitive data theft, targeting multiple industries. The vulnerability was promptly addressed with patches and mitigation/cleanup techniques being shared by Progress Software.

<br />

### **References**

[https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-158a](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-158a)
[https://nvd.nist.gov/vuln/detail/CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)
[https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023](https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023)
[https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations](https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations)
